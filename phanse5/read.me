This is phase 5 with integration
